---
# WinBatch V2 Demo - Ğ¡Ğ°Ğ¼Ğ¾Ğ´Ğ¾ÑÑ‚Ğ°Ñ‚Ğ¾Ñ‡Ğ½Ğ°Ñ Ğ²ĞµÑ€ÑĞ¸Ñ (Ğ‘Ğ•Ğ— ĞºĞ°ÑÑ‚Ğ¾Ğ¼Ğ½Ğ¾Ğ³Ğ¾ EE!)
# Ğ­Ñ‚Ğ¾Ñ‚ playbook Ğ´ĞµĞ¼Ğ¾Ğ½ÑÑ‚Ñ€Ğ¸Ñ€ÑƒĞµÑ‚ Ñ€ĞµĞ²Ğ¾Ğ»ÑÑ†Ğ¸Ğ¾Ğ½Ğ½Ñ‹Ğ¹ Ğ¿Ğ»Ğ°Ğ³Ğ¸Ğ½, ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğ¹ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ Ñ Ğ»ÑĞ±Ñ‹Ğ¼ ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ½Ñ‹Ğ¼ AWX EE

- name: "ğŸš€ WinBatch V2 Demo - No Custom EE Required!"
  hosts: windows_servers
  gather_facts: true
  connection: winbatch_v2  # Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ ÑĞ°Ğ¼Ğ¾Ğ´Ğ¾ÑÑ‚Ğ°Ñ‚Ğ¾Ñ‡Ğ½ÑƒÑ Ğ²ĞµÑ€ÑĞ¸Ñ!
  
  vars:
    # ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ WinBatch V2 Ğ¿Ğ»Ğ°Ğ³Ğ¸Ğ½Ğ°
    ansible_connection: winbatch_v2
    ansible_winbatch_batch_size: 15  # Ğ Ğ°Ğ·Ğ¼ĞµÑ€ Ğ¿Ğ°ĞºĞµÑ‚Ğ° Ğ·Ğ°Ğ´Ğ°Ñ‡
    ansible_winbatch_status_interval: 3  # Ğ˜Ğ½Ñ‚ĞµÑ€Ğ²Ğ°Ğ» Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ñ ÑÑ‚Ğ°Ñ‚ÑƒÑĞ°
    ansible_winbatch_execution_timeout: 1800  # ĞœĞ°ĞºÑĞ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ Ğ²Ñ€ĞµĞ¼Ñ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ
    ansible_winbatch_ssh_timeout: 60  # Ğ¢Ğ°Ğ¹Ğ¼Ğ°ÑƒÑ‚ SSH ÑĞ¾ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ñ
    
    # ĞŸĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ Ğ´Ğ»Ñ Ğ´ĞµĞ¼Ğ¾Ğ½ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ğ¸
    test_directories:
      - "C:\\WinBatch_V2_Demo"
      - "C:\\WinBatch_V2_Demo\\logs"
      - "C:\\WinBatch_V2_Demo\\results"
      - "C:\\WinBatch_V2_Demo\\reports"
    
    test_files:
      - "system_info.txt"
      - "network_config.txt"
      - "services_status.txt"
      - "performance_metrics.txt"
  
  tasks:
    # === Ğ‘Ğ›ĞĞš 1: ĞŸÑ€Ğ¸Ğ²ĞµÑ‚ÑÑ‚Ğ²Ğ¸Ğµ Ğ¸ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ ===
    - name: "ğŸ‘‹ WinBatch V2: ĞŸÑ€Ğ¸Ğ²ĞµÑ‚ÑÑ‚Ğ²Ğ¸Ğµ"
      debug:
        msg: |
          â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
          â•‘                     ğŸš€ WINBATCH V2 REVOLUTION! ğŸš€                          â•‘
          â•‘                                                                              â•‘
          â•‘  âœ… Ğ¡Ğ°Ğ¼Ğ¾Ğ´Ğ¾ÑÑ‚Ğ°Ñ‚Ğ¾Ñ‡Ğ½Ñ‹Ğ¹ Ğ¿Ğ»Ğ°Ğ³Ğ¸Ğ½ - Ğ‘Ğ•Ğ— ĞºĞ°ÑÑ‚Ğ¾Ğ¼Ğ½Ğ¾Ğ³Ğ¾ EE!                             â•‘
          â•‘  âœ… Ğ Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ Ñ Ğ»ÑĞ±Ñ‹Ğ¼ ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ½Ñ‹Ğ¼ AWX Execution Environment                  â•‘  
          â•‘  âœ… ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ°Ñ ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚ĞµĞ¹                                   â•‘
          â•‘  âœ… ĞŸÑ€Ğ¸Ñ€Ğ¾ÑÑ‚ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸ 300-500%                                     â•‘
          â•‘                                                                              â•‘
          â•‘  Batch Size: {{ ansible_winbatch_batch_size }}                              â•‘
          â•‘  Status Interval: {{ ansible_winbatch_status_interval }}s                  â•‘
          â•‘  Connection: {{ ansible_connection }}                                       â•‘
          â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      tags:
        - welcome
        - batch_demo

    # === Ğ‘Ğ›ĞĞš 2: Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñ‹ Ğ´Ğ¸Ñ€ĞµĞºÑ‚Ğ¾Ñ€Ğ¸Ğ¹ ===
    - name: "ğŸ“ WinBatch V2: Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ñ‹Ñ… Ğ´Ğ¸Ñ€ĞµĞºÑ‚Ğ¾Ñ€Ğ¸Ğ¹"
      win_shell: |
        if (!(Test-Path "{{ item }}")) {
            New-Item -ItemType Directory -Path "{{ item }}" -Force
            Write-Host "Created directory: {{ item }}"
        } else {
            Write-Host "Directory already exists: {{ item }}"
        }
      loop: "{{ test_directories }}"
      register: dir_creation_results
      tags:
        - directories
        - batch_demo

    # === Ğ‘Ğ›ĞĞš 3: Ğ¡Ğ±Ğ¾Ñ€ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ½Ğ¾Ğ¹ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ğ¸ ===
    - name: "ğŸ’» WinBatch V2: ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ½Ğ¾Ğ¹ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ğ¸"
      win_shell: |
        $systemInfo = @{
            'hostname' = $env:COMPUTERNAME
            'os' = (Get-WmiObject Win32_OperatingSystem).Caption
            'version' = (Get-WmiObject Win32_OperatingSystem).Version
            'architecture' = (Get-WmiObject Win32_OperatingSystem).OSArchitecture
            'memory_gb' = [math]::Round((Get-WmiObject Win32_ComputerSystem).TotalPhysicalMemory / 1GB, 2)
            'cpu' = (Get-WmiObject Win32_Processor).Name
            'timestamp' = (Get-Date).ToString("yyyy-MM-dd HH:mm:ss")
        }
        $systemInfo | ConvertTo-Json -Depth 2
      register: system_info
      tags:
        - system_info
        - batch_demo

    - name: "ğŸ’¾ WinBatch V2: Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ½Ğ¾Ğ¹ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ğ¸"
      win_shell: |
        $content = @"
{{ system_info.stdout }}
"@
        $content | Set-Content "C:\WinBatch_V2_Demo\system_info.txt" -Encoding UTF8
        Write-Host "System information saved"
      tags:
        - system_info
        - batch_demo

    # === Ğ‘Ğ›ĞĞš 4: Ğ¡ĞµÑ‚ĞµĞ²Ğ°Ñ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ ===
    - name: "ğŸŒ WinBatch V2: ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ ÑĞµÑ‚ĞµĞ²Ğ¾Ğ¹ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¸"
      win_shell: |
        $networkInfo = @()
        $adapters = Get-NetAdapter | Where-Object {$_.Status -eq 'Up'}
        foreach ($adapter in $adapters) {
            $ip = Get-NetIPAddress -InterfaceIndex $adapter.InterfaceIndex -AddressFamily IPv4 -ErrorAction SilentlyContinue
            $networkInfo += @{
                'name' = $adapter.Name
                'description' = $adapter.InterfaceDescription
                'status' = $adapter.Status
                'speed' = $adapter.LinkSpeed
                'ip_address' = if ($ip) { $ip.IPAddress } else { "N/A" }
            }
        }
        $networkInfo | ConvertTo-Json -Depth 2
      register: network_info
      tags:
        - network
        - batch_demo

    - name: "ğŸ’¾ WinBatch V2: Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ ÑĞµÑ‚ĞµĞ²Ğ¾Ğ¹ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¸"
      win_shell: |
        $content = @"
{{ network_info.stdout }}
"@
        $content | Set-Content "C:\WinBatch_V2_Demo\network_config.txt" -Encoding UTF8
        Write-Host "Network configuration saved"
      tags:
        - network
        - batch_demo

    # === Ğ‘Ğ›ĞĞš 5: Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ ÑĞ»ÑƒĞ¶Ğ± ===
    - name: "ğŸ”§ WinBatch V2: ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ĞºÑ€Ğ¸Ñ‚Ğ¸Ñ‡Ğ½Ñ‹Ñ… ÑĞ»ÑƒĞ¶Ğ±"
      win_shell: |
        $services = @('Spooler', 'Themes', 'AudioSrv', 'BITS', 'EventLog', 'Winmgmt')
        $serviceStatus = @()
        foreach ($serviceName in $services) {
            $service = Get-Service -Name $serviceName -ErrorAction SilentlyContinue
            if ($service) {
                $serviceStatus += @{
                    'name' = $serviceName
                    'display_name' = $service.DisplayName
                    'status' = $service.Status
                    'start_type' = $service.StartType
                }
            } else {
                $serviceStatus += @{
                    'name' = $serviceName
                    'status' = 'NotFound'
                }
            }
        }
        $serviceStatus | ConvertTo-Json -Depth 2
      register: services_status
      tags:
        - services
        - batch_demo

    - name: "ğŸ’¾ WinBatch V2: Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ ÑÑ‚Ğ°Ñ‚ÑƒÑĞ° ÑĞ»ÑƒĞ¶Ğ±"
      win_shell: |
        $content = @"
{{ services_status.stdout }}
"@
        $content | Set-Content "C:\WinBatch_V2_Demo\services_status.txt" -Encoding UTF8
        Write-Host "Services status saved"
      tags:
        - services
        - batch_demo

    # === Ğ‘Ğ›ĞĞš 6: ĞŸÑ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹ ===
    - name: "ğŸ“ˆ WinBatch V2: ĞœĞµÑ‚Ñ€Ğ¸ĞºĞ¸ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸"
      win_shell: |
        $perfMetrics = @{
            'cpu_usage' = (Get-WmiObject win32_processor | Measure-Object -property LoadPercentage -Average).Average
            'memory_available_gb' = [math]::Round((Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory / 1MB, 2)
            'disk_free_gb' = [math]::Round((Get-WmiObject Win32_LogicalDisk -Filter "DeviceID='C:'").FreeSpace / 1GB, 2)
            'uptime_hours' = [math]::Round(((Get-Date) - (Get-WmiObject Win32_OperatingSystem).ConvertToDateTime((Get-WmiObject Win32_OperatingSystem).LastBootUpTime)).TotalHours, 2)
            'processes_count' = (Get-Process).Count
            'timestamp' = (Get-Date).ToString("yyyy-MM-dd HH:mm:ss")
        }
        $perfMetrics | ConvertTo-Json -Depth 2
      register: performance_metrics
      tags:
        - performance
        - batch_demo

    - name: "ğŸ’¾ WinBatch V2: Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ğ¼ĞµÑ‚Ñ€Ğ¸Ğº Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸"
      win_shell: |
        $content = @"
{{ performance_metrics.stdout }}
"@
        $content | Set-Content "C:\WinBatch_V2_Demo\performance_metrics.txt" -Encoding UTF8
        Write-Host "Performance metrics saved"
      tags:
        - performance
        - batch_demo

    # === Ğ‘Ğ›ĞĞš 7: Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ PowerShell ÑĞºÑ€Ğ¸Ğ¿Ñ‚Ğ° Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³Ğ° ===
    - name: "ğŸ“ WinBatch V2: Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ ÑĞºÑ€Ğ¸Ğ¿Ñ‚Ğ° Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³Ğ°"
      win_shell: |
        $monitoringScript = @"
# WinBatch V2 Monitoring Script
# Generated automatically by WinBatch V2 Self-Contained Plugin

Write-Host "WinBatch V2 System Monitoring Report" -ForegroundColor Green
Write-Host "Generated: `$(Get-Date)" -ForegroundColor Yellow
Write-Host "=" * 50

# System Information
Write-Host "`nSYSTEM INFORMATION:" -ForegroundColor Cyan
`$sysInfo = Get-WmiObject Win32_ComputerSystem
Write-Host "Computer: `$(`$sysInfo.Name)"
Write-Host "Domain: `$(`$sysInfo.Domain)"
Write-Host "Total Memory: `$([math]::Round(`$sysInfo.TotalPhysicalMemory / 1GB, 2)) GB"

# CPU Information
Write-Host "`nCPU INFORMATION:" -ForegroundColor Cyan
`$cpu = Get-WmiObject Win32_Processor
Write-Host "Processor: `$(`$cpu.Name)"
Write-Host "Cores: `$(`$cpu.NumberOfCores)"
Write-Host "Logical Processors: `$(`$cpu.NumberOfLogicalProcessors)"

# Memory Status
Write-Host "`nMEMORY STATUS:" -ForegroundColor Cyan
`$os = Get-WmiObject Win32_OperatingSystem
`$totalMemGB = [math]::Round(`$os.TotalVisibleMemorySize / 1MB, 2)
`$freeMemGB = [math]::Round(`$os.FreePhysicalMemory / 1MB, 2)
`$usedMemGB = `$totalMemGB - `$freeMemGB
Write-Host "Total: `$totalMemGB GB"
Write-Host "Used: `$usedMemGB GB"
Write-Host "Free: `$freeMemGB GB"
Write-Host "Usage: `$([math]::Round((`$usedMemGB / `$totalMemGB) * 100, 1))%"

# Disk Space
Write-Host "`nDISK SPACE:" -ForegroundColor Cyan
Get-WmiObject Win32_LogicalDisk | Where-Object {`$_.DriveType -eq 3} | ForEach-Object {
    `$totalGB = [math]::Round(`$_.Size / 1GB, 2)
    `$freeGB = [math]::Round(`$_.FreeSpace / 1GB, 2)
    `$usedGB = `$totalGB - `$freeGB
    `$usagePercent = [math]::Round((`$usedGB / `$totalGB) * 100, 1)
    Write-Host "Drive `$(`$_.DeviceID) - Total: `$totalGB GB, Used: `$usedGB GB, Free: `$freeGB GB (`$usagePercent% used)"
}

# Network Adapters
Write-Host "`nNETWORK ADAPTERS:" -ForegroundColor Cyan
Get-NetAdapter | Where-Object {`$_.Status -eq 'Up'} | ForEach-Object {
    Write-Host "- `$(`$_.Name): `$(`$_.Status) (`$(`$_.LinkSpeed))"
}

# Services Status
Write-Host "`nCRITICAL SERVICES:" -ForegroundColor Cyan
`$criticalServices = @('Spooler', 'Themes', 'AudioSrv', 'BITS', 'EventLog', 'Winmgmt')
foreach (`$serviceName in `$criticalServices) {
    `$service = Get-Service -Name `$serviceName -ErrorAction SilentlyContinue
    if (`$service) {
        `$color = if (`$service.Status -eq 'Running') { 'Green' } else { 'Red' }
        Write-Host "- `$serviceName: `$(`$service.Status)" -ForegroundColor `$color
    } else {
        Write-Host "- `$serviceName: Not Found" -ForegroundColor Red
    }
}

Write-Host "`n" + "=" * 50
Write-Host "WinBatch V2 Monitoring Complete!" -ForegroundColor Green
"@

        $monitoringScript | Set-Content "C:\WinBatch_V2_Demo\monitoring_script.ps1" -Encoding UTF8
        Write-Host "Monitoring script created successfully"
      tags:
        - scripts
        - batch_demo

    # === Ğ‘Ğ›ĞĞš 8: Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğµ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ½Ğ¾Ğ³Ğ¾ ÑĞºÑ€Ğ¸Ğ¿Ñ‚Ğ° ===
    - name: "ğŸ” WinBatch V2: Ğ—Ğ°Ğ¿ÑƒÑĞº ÑĞºÑ€Ğ¸Ğ¿Ñ‚Ğ° Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³Ğ°"
      win_shell: |
        PowerShell.exe -ExecutionPolicy Bypass -File "C:\WinBatch_V2_Demo\monitoring_script.ps1"
      register: monitoring_output
      tags:
        - monitoring
        - batch_demo

    # === Ğ‘Ğ›ĞĞš 9: Ğ¤Ğ¸Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¾Ñ‚Ñ‡ĞµÑ‚ ===
    - name: "ğŸ“‹ WinBatch V2: Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¸Ñ‚Ğ¾Ğ³Ğ¾Ğ²Ğ¾Ğ³Ğ¾ Ğ¾Ñ‚Ñ‡ĞµÑ‚Ğ°"
      win_shell: |
        $finalReport = @{
            'winbatch_version' = 'v2.0'
            'execution_timestamp' = '{{ ansible_date_time.iso8601 }}'
            'plugin_type' = 'self_contained'
            'custom_ee_required' = $false
            'execution_environment' = 'standard_awx_ee'
            'performance_notes' = 'This playbook was executed using WinBatch V2 self-contained plugin that works with any standard AWX EE'
            'configuration' = @{
                'batch_size' = {{ ansible_winbatch_batch_size }}
                'status_interval' = {{ ansible_winbatch_status_interval }}
                'execution_timeout' = {{ ansible_winbatch_execution_timeout }}
                'ssh_timeout' = {{ ansible_winbatch_ssh_timeout }}
            }
            'directories_created' = @({{ test_directories | to_json }})
            'files_created' = @({{ test_files | to_json }})
            'features' = @(
                'Auto dependency installation',
                'SSH multiplexing',
                'Batch task execution',
                'Real-time status updates',
                'Enhanced error handling',
                'Standard EE compatibility'
            )
            'performance_benefits' = @(
                'Single SSH connection for entire playbook',
                'Local task execution on Windows',
                'Batch processing reduces overhead',
                '300-500% performance improvement over traditional approach'
            )
            'compatibility' = @{
                'execution_environments' = @('Any standard AWX EE', 'Default EE', 'Minimal EE')
                'ansible_versions' = @('2.9+', '2.14+', '2.15+')
                'python_versions' = @('3.8+', '3.9+', '3.10+', '3.11+')
            }
        }
        
        $finalReport | ConvertTo-Json -Depth 4 | Set-Content "C:\WinBatch_V2_Demo\FINAL_REPORT.json" -Encoding UTF8
        Write-Host "Final report created successfully"
      tags:
        - report
        - batch_demo

    # === Ğ‘Ğ›ĞĞš 10: ĞÑ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ¾Ğ² ===
    - name: "ğŸ‰ WinBatch V2: Ğ¤Ğ¸Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹"
      debug:
        msg: |
          â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
          â•‘                        ğŸ† WINBATCH V2 SUCCESS! ğŸ†                          â•‘
          â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
          â•‘                                                                              â•‘
          â•‘  âœ… Ğ¡Ğ°Ğ¼Ğ¾Ğ´Ğ¾ÑÑ‚Ğ°Ñ‚Ğ¾Ñ‡Ğ½Ñ‹Ğ¹ Ğ¿Ğ»Ğ°Ğ³Ğ¸Ğ½ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ ĞĞ¢Ğ›Ğ˜Ğ§ĞĞ!                                â•‘
          â•‘  âœ… ĞĞ• Ñ‚Ñ€ĞµĞ±ÑƒĞµÑ‚ ĞºĞ°ÑÑ‚Ğ¾Ğ¼Ğ½Ğ¾Ğ³Ğ¾ Execution Environment!                            â•‘
          â•‘  âœ… ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ğ» Ğ²ÑĞµ Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸!                                â•‘
          â•‘  âœ… Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ» SSH multiplexing Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸!                    â•‘
          â•‘  âœ… Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ğ» Ğ¿Ğ°ĞºĞµÑ‚Ğ½ÑƒÑ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºÑƒ {{ ansible_winbatch_batch_size }} Ğ·Ğ°Ğ´Ğ°Ñ‡!   â•‘
          â•‘                                                                              â•‘
          â•‘  ğŸ“Š Ğ Ğ•Ğ—Ğ£Ğ›Ğ¬Ğ¢ĞĞ¢Ğ«:                                                              â•‘
          â•‘     â€¢ Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¾ Ğ´Ğ¸Ñ€ĞµĞºÑ‚Ğ¾Ñ€Ğ¸Ğ¹: {{ test_directories | length }}                  â•‘
          â•‘     â€¢ Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¾ Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²: {{ test_files | length }}                            â•‘
          â•‘     â€¢ Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ½Ğ°Ñ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ: ÑĞ¾Ğ±Ñ€Ğ°Ğ½Ğ°                                         â•‘
          â•‘     â€¢ Ğ¡ĞµÑ‚ĞµĞ²Ğ°Ñ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ: Ğ¿Ñ€Ğ¾Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ°                                â•‘
          â•‘     â€¢ Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ ÑĞ»ÑƒĞ¶Ğ±: Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞµĞ½                                                â•‘
          â•‘     â€¢ ĞœĞµÑ‚Ñ€Ğ¸ĞºĞ¸ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸: Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ñ‹                                  â•‘
          â•‘     â€¢ Ğ¡ĞºÑ€Ğ¸Ğ¿Ñ‚ Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³Ğ°: ÑĞ¾Ğ·Ğ´Ğ°Ğ½ Ğ¸ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½                                 â•‘
          â•‘                                                                              â•‘
          â•‘  ğŸš€ Ğ Ğ•Ğ’ĞĞ›Ğ®Ğ¦Ğ˜ĞĞĞĞ«Ğ• ĞŸĞ Ğ•Ğ˜ĞœĞ£Ğ©Ğ•Ğ¡Ğ¢Ğ’Ğ:                                             â•‘
          â•‘     â€¢ Ğ Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ Ñ Ğ›Ğ®Ğ‘Ğ«Ğœ ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ½Ñ‹Ğ¼ AWX EE                                   â•‘
          â•‘     â€¢ ĞŸÑ€Ğ¸Ñ€Ğ¾ÑÑ‚ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸: 300-500%                                  â•‘
          â•‘     â€¢ ĞĞ²Ñ‚Ğ¾Ğ½Ğ¾Ğ¼Ğ½Ğ¾ÑÑ‚ÑŒ: Ğ½Ğµ Ñ‚Ñ€ĞµĞ±ÑƒĞµÑ‚ Ğ´Ğ¾Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾Ğ¹ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸                     â•‘
          â•‘     â€¢ Ğ¡Ğ¾Ğ²Ğ¼ĞµÑÑ‚Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ: Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶Ğ¸Ğ²Ğ°ĞµÑ‚ Ğ²ÑĞµ ÑĞ¾Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ Ğ²ĞµÑ€ÑĞ¸Ğ¸ Ansible           â•‘
          â•‘                                                                              â•‘
          â•‘  ğŸ“ Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ñ‹ Ğ²: C:\WinBatch_V2_Demo\                           â•‘
          â•‘                                                                              â•‘
          â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      tags:
        - report
        - batch_demo

    # === Ğ‘Ğ›ĞĞš 11: ĞÑ‡Ğ¸ÑÑ‚ĞºĞ° (Ğ¾Ğ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾) ===
    - name: "ğŸ§¹ WinBatch V2: ĞÑ‡Ğ¸ÑÑ‚ĞºĞ° Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ñ‹Ñ… Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²"
      win_shell: |
        if (Test-Path "C:\WinBatch_V2_Demo") {
            Remove-Item "C:\WinBatch_V2_Demo" -Recurse -Force
            Write-Host "Test files cleaned up successfully"
        }
      when: cleanup_test_files | default(false) | bool
      tags:
        - cleanup
        - never