# üîß WinBatch V2 - –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ù–µ–ø–æ–ª–∞–¥–æ–∫

## ‚ùå –ü—Ä–æ–±–ª–µ–º–∞: "Could not find a version that satisfies the requirement threading-timer"

### üéØ –†–µ—à–µ–Ω–∏–µ
–≠—Ç–∞ –æ—à–∏–±–∫–∞ –≤–æ–∑–Ω–∏–∫–∞–ª–∞ –≤ —Ä–∞–Ω–Ω–µ–π –≤–µ—Ä—Å–∏–∏ –ø–ª–∞–≥–∏–Ω–∞ –∏–∑-–∑–∞ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏. **–ü—Ä–æ–±–ª–µ–º–∞ –ò–°–ü–†–ê–í–õ–ï–ù–ê!**

**WinBatch V2** —Ç–µ–ø–µ—Ä—å **–ù–ï –¢–†–ï–ë–£–ï–¢** –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–ª—å–∫–æ:
- ‚úÖ –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ Python
- ‚úÖ –°–∏—Å—Ç–µ–º–Ω—ã–µ SSH –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
- ‚úÖ –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –º–æ–¥—É–ª–∏ Ansible

### üöÄ –ß—Ç–æ –ò–∑–º–µ–Ω–∏–ª–æ—Å—å
```python
# –°–¢–ê–†–ê–Ø –≤–µ—Ä—Å–∏—è (—Å –æ—à–∏–±–∫–æ–π)
required_packages = [
    'paramiko>=2.10.0',
    'threading-timer>=1.0.0',  # ‚ùå –≠—Ç–æ—Ç –ø–∞–∫–µ—Ç –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç!
]

# –ù–û–í–ê–Ø –≤–µ—Ä—Å–∏—è (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞)
# –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–ª—å–∫–æ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã SSH
# –ë–ï–ó –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π!
```

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –†–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

### 1. –ë—ã—Å—Ç—Ä—ã–π –¢–µ—Å—Ç
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç
ansible-playbook -i inventory/winbatch_v2_hosts.yml winbatch_v2_test.yml
```

### 2. –ü–æ–ª–Ω–∞—è –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø–æ–ª–Ω—É—é –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—é
ansible-playbook -i inventory/winbatch_v2_hosts.yml winbatch_v2_demo.yml
```

## üõ†Ô∏è –î—Ä—É–≥–∏–µ –í–æ–∑–º–æ–∂–Ω—ã–µ –ü—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–±–ª–µ–º–∞: SSH —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –Ω–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è
**–ü—Ä–∏—á–∏–Ω–∞**: OpenSSH Server –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ Windows
**–†–µ—à–µ–Ω–∏–µ**:
```powershell
# –ù–∞ Windows —Å–µ—Ä–≤–µ—Ä–µ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
Add-WindowsCapability -Online -Name OpenSSH.Server~~~~0.0.1.0
Start-Service sshd
Set-Service -Name sshd -StartupType 'Automatic'

# –ù–∞—Å—Ç—Ä–æ–π—Ç–µ PowerShell –∫–∞–∫ shell –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
New-ItemProperty -Path "HKLM:\SOFTWARE\OpenSSH" -Name DefaultShell -Value "C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe" -PropertyType String -Force
```

### –ü—Ä–æ–±–ª–µ–º–∞: "Connection plugin 'winbatch_v2' not found"
**–ü—Ä–∏—á–∏–Ω–∞**: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—É—Ç—å –∫ –ø–ª–∞–≥–∏–Ω—É –≤ ansible.cfg
**–†–µ—à–µ–Ω–∏–µ**:
```ini
# –í ansible.cfg —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É–∫–∞–∑–∞–Ω –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—É—Ç—å:
[defaults]
connection_plugins = plugins/connection
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ú–µ–¥–ª–µ–Ω–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
**–ü—Ä–∏—á–∏–Ω–∞**: –ù–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ batch_size
**–†–µ—à–µ–Ω–∏–µ**:
```yaml
# –î–ª—è –º–æ—â–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤
ansible_winbatch_batch_size: 30

# –î–ª—è –º–µ–¥–ª–µ–Ω–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤
ansible_winbatch_batch_size: 5
```

### –ü—Ä–æ–±–ª–µ–º–∞: –¢–∞–π–º–∞—É—Ç—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
**–ü—Ä–∏—á–∏–Ω–∞**: –°–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–µ —Ç–∞–π–º–∞—É—Ç—ã
**–†–µ—à–µ–Ω–∏–µ**:
```yaml
# –£–≤–µ–ª–∏—á—å—Ç–µ —Ç–∞–π–º–∞—É—Ç—ã –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ
ansible_winbatch_execution_timeout: 7200  # 2 —á–∞—Å–∞
ansible_winbatch_ssh_timeout: 120         # 2 –º–∏–Ω—É—Ç—ã
```

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ SSH –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
```yaml
- name: "Test SSH connectivity"
  shell: ssh -V
  delegate_to: localhost
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ Windows OpenSSH
```yaml
- name: "Test Windows SSH"
  win_shell: Get-Service sshd
  connection: winrm  # –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ WinRM –¥–ª—è –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ü–ª–∞–≥–∏–Ω–∞
```yaml
- name: "Test WinBatch V2 Plugin"
  debug:
    msg: "WinBatch V2 plugin loaded successfully"
  connection: winbatch_v2
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –í–∫–ª—é—á–µ–Ω–∏–µ –ü–æ–¥—Ä–æ–±–Ω–æ–≥–æ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
```ini
# –í ansible.cfg
[defaults]
log_path = /tmp/ansible.log
verbosity = 2

[winbatch]
enable_performance_logging = true
```

### –ê–Ω–∞–ª–∏–∑ –í—Ä–µ–º–µ–Ω–∏ –í—ã–ø–æ–ª–Ω–µ–Ω–∏—è
```yaml
- name: "Performance test"
  win_shell: |
    $start = Get-Date
    # –í–∞—à–∏ –∫–æ–º–∞–Ω–¥—ã –∑–¥–µ—Å—å
    $end = Get-Date
    Write-Host "Execution time: $(($end - $start).TotalSeconds) seconds"
  connection: winbatch_v2
```

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è –ü—Ä–æ–¥–∞–∫—à–µ–Ω–∞
1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ SSH –∫–ª—é—á–∏** –≤–º–µ—Å—Ç–æ –ø–∞—Ä–æ–ª–µ–π
2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π batch_size** (15-25 –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —Å–ª—É—á–∞–µ–≤)
3. **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** —á–µ—Ä–µ–∑ –ª–æ–≥–∏
4. **–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –Ω–∞ dev –æ–∫—Ä—É–∂–µ–Ω–∏–∏** –ø–µ—Ä–µ–¥ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–æ–º

### –î–ª—è –†–∞–∑—Ä–∞–±–æ—Ç–∫–∏
1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ winbatch_v2_test.yml** –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏
2. **–í–∫–ª—é—á–∏—Ç–µ –ø–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** (verbosity = 3)
3. **–£–º–µ–Ω—å—à–∏—Ç–µ batch_size** (5-10) –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
4. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ—Ä–æ—Ç–∫–∏–µ —Ç–∞–π–º–∞—É—Ç—ã** –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ feedback

## üÜò –ü–æ–ª—É—á–µ–Ω–∏–µ –ü–æ–º–æ—â–∏

–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –Ω–µ —Ä–µ—à–µ–Ω–∞:

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏** AWX Job execution
2. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π playbook** winbatch_v2_test.yml
3. **–£–±–µ–¥–∏—Ç–µ—Å—å –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫** –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å SSH** –Ω–∞ Windows —Å–µ—Ä–≤–µ—Ä–µ

## ‚úÖ –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–π –°–ø–∏—Å–æ–∫

- [ ] OpenSSH Server —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –∑–∞–ø—É—â–µ–Ω –Ω–∞ Windows
- [ ] SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç (—Ç–µ—Å—Ç —á–µ—Ä–µ–∑ –æ–±—ã—á–Ω—ã–π ssh)
- [ ] ansible.cfg —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—É—Ç—å –∫ –ø–ª–∞–≥–∏–Ω—É
- [ ] –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Å ansible_connection: winbatch_v2
- [ ] –¢–µ—Å—Ç–æ–≤—ã–π playbook –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —É—Å–ø–µ—à–Ω–æ
- [ ] –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–∂–∏–¥–∞–Ω–∏—è–º (3-5x —É–ª—É—á—à–µ–Ω–∏–µ)

---

**–ü–æ–º–Ω–∏—Ç–µ**: WinBatch V2 —Ç–µ–ø–µ—Ä—å –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–∞–º–æ–¥–æ—Å—Ç–∞—Ç–æ—á–µ–Ω –∏ –ù–ï —Ç—Ä–µ–±—É–µ—Ç –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π! üöÄ 